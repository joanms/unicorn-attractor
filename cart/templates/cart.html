{% extends "base.html" %}

{% load bootstrap_tags %} 

{% block page_title %}Cart{% endblock %}

{% block content %}

<div class="mx-auto medium-container">
    <h1>Cart</h1>
    
    {% if cart_items %}
        <!--If there are items in the cart, they will appear here-->

        <div class="table-responsive">
            
            <table class="table">
                
                <thead>
                    <tr>
                        <th scope="col" style="width: 20%">Title</th>
                        <th scope="col" style="width: 45%">Description</th>
                        <th scope="col" style="width: 25%">Upvotes</th>
                        <th scope="col" style="width: 10%">Price</th>
                    </tr>
                </thead>
                
                <tbody>
                    {% for item in cart_items %}
                        <tr>
                            <th scope="row">{{ item.feature.title }}</th>
                            <td>{{ item.feature.description|truncatewords:20 }}</td>
                            <td>
                                <form class="form-inline" method="post" action="{% url 'adjust_cart' item.id %}">
                                    {% csrf_token %}
                                    <div class="form-group">
                                        <div class="input-group">
                                            <input name="quantity" type="number" min="0" max="999" class="form-control" placeholder="{{ item.quantity }}">
                                        </div>
                                    </div>
                                    <button type="submit" class="btn btn-secondary"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span>Update</button>
                                </form>
                            </td>
                            <td>@€{{ item.feature.price }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
                
            </table>
            
            <p><a href="{% url 'list_features' %}">Browse other features to upvote.</a></p>
            
            <strong>Total Fee: €{{ total }}</strong>
                    
        </div>
        
        <p><a href="{% url 'checkout' %}"><button type="submit" class="btn btn-secondary">Checkout</button></a></p>

    {% else %}
    
        <!--If there are no items in the cart, the following text will appear-->
        <p>Your cart is empty. Look for features to upvote <a href="{% url 'list_features' %}">here</a>.</p>
        
    {% endif %}
    
    
</div>

{% endblock %}